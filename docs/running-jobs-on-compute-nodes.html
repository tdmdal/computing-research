<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Running Jobs on Compute Nodes | Rotman Research Node User Guide</title>
  <meta name="description" content="3 Running Jobs on Compute Nodes | Rotman Research Node User Guide" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Running Jobs on Compute Nodes | Rotman Research Node User Guide" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Running Jobs on Compute Nodes | Rotman Research Node User Guide" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-software.html"/>
<link rel="next" href="linux-command-quick-reference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rotman-research-node"><i class="fa fa-check"></i>Rotman Research Node</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-user-guide"><i class="fa fa-check"></i>About this User Guide</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#requesting-an-account"><i class="fa fa-check"></i><b>1.1</b> Requesting an Account</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#logging-on-to-rrn"><i class="fa fa-check"></i><b>1.2</b> Logging on to RRN</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#resetting-password"><i class="fa fa-check"></i><b>1.3</b> Resetting Password</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#directory-structure-and-disk-quota"><i class="fa fa-check"></i><b>1.4</b> Directory Structure and Disk Quota</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#transferring-files"><i class="fa fa-check"></i><b>1.5</b> Transferring Files</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started.html"><a href="getting-started.html#loading-software"><i class="fa fa-check"></i><b>1.6</b> Loading Software</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="using-software.html"><a href="using-software.html"><i class="fa fa-check"></i><b>2</b> Using Software</a>
<ul>
<li class="chapter" data-level="2.1" data-path="using-software.html"><a href="using-software.html#best-practice"><i class="fa fa-check"></i><b>2.1</b> Best Practice</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="using-software.html"><a href="using-software.html#interactive-mode-vs-batch-mode"><i class="fa fa-check"></i><b>2.1.1</b> Interactive mode vs batch mode</a></li>
<li class="chapter" data-level="2.1.2" data-path="using-software.html"><a href="using-software.html#rrn-vs-compute-nodes"><i class="fa fa-check"></i><b>2.1.2</b> RRN vs compute nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="using-software.html"><a href="using-software.html#using-python"><i class="fa fa-check"></i><b>2.2</b> Using Python</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="using-software.html"><a href="using-software.html#python-setup"><i class="fa fa-check"></i><b>2.2.1</b> Setup</a></li>
<li class="chapter" data-level="2.2.2" data-path="using-software.html"><a href="using-software.html#interactive-mode-python-console"><i class="fa fa-check"></i><b>2.2.2</b> Interactive mode (Python console)</a></li>
<li class="chapter" data-level="2.2.3" data-path="using-software.html"><a href="using-software.html#batch-mode"><i class="fa fa-check"></i><b>2.2.3</b> Batch mode</a></li>
<li class="chapter" data-level="2.2.4" data-path="using-software.html"><a href="using-software.html#install-packages"><i class="fa fa-check"></i><b>2.2.4</b> Install packages</a></li>
<li class="chapter" data-level="2.2.5" data-path="using-software.html"><a href="using-software.html#run-python-on-compute-nodes"><i class="fa fa-check"></i><b>2.2.5</b> Run Python on compute nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="using-software.html"><a href="using-software.html#using-r"><i class="fa fa-check"></i><b>2.3</b> Using R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="using-software.html"><a href="using-software.html#setup"><i class="fa fa-check"></i><b>2.3.1</b> Setup</a></li>
<li class="chapter" data-level="2.3.2" data-path="using-software.html"><a href="using-software.html#interactive-mode-r-console"><i class="fa fa-check"></i><b>2.3.2</b> Interactive mode (R console)</a></li>
<li class="chapter" data-level="2.3.3" data-path="using-software.html"><a href="using-software.html#batch-mode-1"><i class="fa fa-check"></i><b>2.3.3</b> Batch mode</a></li>
<li class="chapter" data-level="2.3.4" data-path="using-software.html"><a href="using-software.html#install-r-packages"><i class="fa fa-check"></i><b>2.3.4</b> Install R packages</a></li>
<li class="chapter" data-level="2.3.5" data-path="using-software.html"><a href="using-software.html#run-r-on-compute-nodes"><i class="fa fa-check"></i><b>2.3.5</b> Run R on compute nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="using-software.html"><a href="using-software.html#using-matlab"><i class="fa fa-check"></i><b>2.4</b> Using Matlab</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="using-software.html"><a href="using-software.html#setup-1"><i class="fa fa-check"></i><b>2.4.1</b> Setup</a></li>
<li class="chapter" data-level="2.4.2" data-path="using-software.html"><a href="using-software.html#interactive-mode-without-gui"><i class="fa fa-check"></i><b>2.4.2</b> Interactive mode without GUI</a></li>
<li class="chapter" data-level="2.4.3" data-path="using-software.html"><a href="using-software.html#interactive-mode-with-gui"><i class="fa fa-check"></i><b>2.4.3</b> Interactive mode with GUI</a></li>
<li class="chapter" data-level="2.4.4" data-path="using-software.html"><a href="using-software.html#batch-mode-2"><i class="fa fa-check"></i><b>2.4.4</b> Batch mode</a></li>
<li class="chapter" data-level="2.4.5" data-path="using-software.html"><a href="using-software.html#run-matlab-on-compute-nodes"><i class="fa fa-check"></i><b>2.4.5</b> Run Matlab on compute nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="using-software.html"><a href="using-software.html#using-stata"><i class="fa fa-check"></i><b>2.5</b> Using Stata</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="using-software.html"><a href="using-software.html#setup-2"><i class="fa fa-check"></i><b>2.5.1</b> Setup</a></li>
<li class="chapter" data-level="2.5.2" data-path="using-software.html"><a href="using-software.html#interactive-mode-without-gui-1"><i class="fa fa-check"></i><b>2.5.2</b> Interactive mode without GUI</a></li>
<li class="chapter" data-level="2.5.3" data-path="using-software.html"><a href="using-software.html#interactive-mode-with-gui-1"><i class="fa fa-check"></i><b>2.5.3</b> Interactive mode with GUI</a></li>
<li class="chapter" data-level="2.5.4" data-path="using-software.html"><a href="using-software.html#batch-mode-3"><i class="fa fa-check"></i><b>2.5.4</b> Batch mode</a></li>
<li class="chapter" data-level="2.5.5" data-path="using-software.html"><a href="using-software.html#a-note-on-statamp"><i class="fa fa-check"></i><b>2.5.5</b> A note on Stata/MP</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="using-software.html"><a href="using-software.html#using-sas"><i class="fa fa-check"></i><b>2.6</b> Using SAS</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="using-software.html"><a href="using-software.html#setup-3"><i class="fa fa-check"></i><b>2.6.1</b> Setup</a></li>
<li class="chapter" data-level="2.6.2" data-path="using-software.html"><a href="using-software.html#interactive-mode-without-gui-2"><i class="fa fa-check"></i><b>2.6.2</b> Interactive mode without GUI</a></li>
<li class="chapter" data-level="2.6.3" data-path="using-software.html"><a href="using-software.html#interactive-mode-with-gui-2"><i class="fa fa-check"></i><b>2.6.3</b> Interactive mode with GUI</a></li>
<li class="chapter" data-level="2.6.4" data-path="using-software.html"><a href="using-software.html#batch-mode-4"><i class="fa fa-check"></i><b>2.6.4</b> Batch mode</a></li>
<li class="chapter" data-level="2.6.5" data-path="using-software.html"><a href="using-software.html#run-sas-on-compute-nodes"><i class="fa fa-check"></i><b>2.6.5</b> Run SAS on compute nodes</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="using-software.html"><a href="using-software.html#managing-jobs-in-batch-mode"><i class="fa fa-check"></i><b>2.7</b> Managing Jobs in Batch Mode</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="using-software.html"><a href="using-software.html#monitor-jobs"><i class="fa fa-check"></i><b>2.7.1</b> Monitor jobs</a></li>
<li class="chapter" data-level="2.7.2" data-path="using-software.html"><a href="using-software.html#terminate-jobs"><i class="fa fa-check"></i><b>2.7.2</b> Terminate jobs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="running-jobs-on-compute-nodes.html"><a href="running-jobs-on-compute-nodes.html"><i class="fa fa-check"></i><b>3</b> Running Jobs on Compute Nodes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="running-jobs-on-compute-nodes.html"><a href="running-jobs-on-compute-nodes.html#compute-nodes"><i class="fa fa-check"></i><b>3.1</b> Compute Nodes</a></li>
<li class="chapter" data-level="3.2" data-path="running-jobs-on-compute-nodes.html"><a href="running-jobs-on-compute-nodes.html#job-submission-script"><i class="fa fa-check"></i><b>3.2</b> Job Submission Script</a></li>
<li class="chapter" data-level="3.3" data-path="running-jobs-on-compute-nodes.html"><a href="running-jobs-on-compute-nodes.html#submitting-jobs-to-compute-nodes"><i class="fa fa-check"></i><b>3.3</b> Submitting Jobs to Compute Nodes</a></li>
<li class="chapter" data-level="3.4" data-path="running-jobs-on-compute-nodes.html"><a href="running-jobs-on-compute-nodes.html#managing-jobs-on-compute-nodes"><i class="fa fa-check"></i><b>3.4</b> Managing Jobs on Compute Nodes</a></li>
<li class="chapter" data-level="3.5" data-path="running-jobs-on-compute-nodes.html"><a href="running-jobs-on-compute-nodes.html#best-practice-1"><i class="fa fa-check"></i><b>3.5</b> Best Practice</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="linux-command-quick-reference.html"><a href="linux-command-quick-reference.html"><i class="fa fa-check"></i><b>A</b> Linux Command Quick Reference</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rotman Research Node User Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="running-jobs-on-compute-nodes" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Running Jobs on Compute Nodes<a href="running-jobs-on-compute-nodes.html#running-jobs-on-compute-nodes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="compute-nodes" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Compute Nodes<a href="running-jobs-on-compute-nodes.html#compute-nodes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Thus far, this guide has described how to run your code/jobs on RRN itself. As explained in the section <a href="using-software.html#rrn-vs-compute-nodes">RRN vs compute nodes</a>, if you have very large compute-intensive jobs (e.g., jobs that need more than 16 CPUs and more than 12hrs of run time), it is recommended to submit them to compute nodes. Resources on RRN (a login node) are always shared. As a result, when the RRN is busy, everyone gets less resources and your code runs slower. One the other hand, you could request resources on compute nodes, and once granted, they are exclusively for your job during its computation.</p>
<p>Rotman users have access to 8 compute nodes via a “standard” partition (a partition is just a logical set of compute nodes). Each compute node has 24 CPUs and 240G memory.</p>
<p>In this section, we briefly discuss how to submit jobs to compute nodes. For a more detailed document on how to use compute nodes, see <a href="https://cac.queensu.ca/wiki/index.php/SLURM">How to Run Jobs Using a Scheduler</a> on the <a href="https://cac.queensu.ca/wiki/index.php/Main_Page">CAC Wiki</a> website.</p>
</div>
<div id="job-submission-script" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Job Submission Script<a href="running-jobs-on-compute-nodes.html#job-submission-script" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Resources on compute nodes are managed by a workload management system called <a href="https://slurm.schedmd.com/overview.html">Slurm (Simple Linux Utility for Resource Manager)</a>. In order to request resources on compute nodes and submit a job, you will need to write a job submission script. The script is a <a href="linux-command-quick-reference.html#linux-command-quick-reference">Bash shell</a> script that contains a set of SLURM directives (or commands) describing resource requests and other submissions options.</p>
<p>Below is a sample script for submitting a Python job. You could name the script as you like (e.g.,<code>job.sh</code>), and store it in the same directory as your Python script.</p>
<style type="text/css">
pre.numberSource code > span > a:first-child::before {
  left: -0.1em;
}
</style>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource abc numberLines"><code class="sourceCode abc"><span id="cb36-1"><a href="running-jobs-on-compute-nodes.html#cb36-1"></a>#!/bin/bash</span>
<span id="cb36-2"><a href="running-jobs-on-compute-nodes.html#cb36-2"></a></span>
<span id="cb36-3"><a href="running-jobs-on-compute-nodes.html#cb36-3"></a>#SBATCH --job-name=project_abc    # create a job name</span>
<span id="cb36-4"><a href="running-jobs-on-compute-nodes.html#cb36-4"></a>#SBATCH --partition=standard      # specify job partition</span>
<span id="cb36-5"><a href="running-jobs-on-compute-nodes.html#cb36-5"></a>#SBATCH --mail-type=ALL           # email you when the job starts, stops, etc.</span>
<span id="cb36-6"><a href="running-jobs-on-compute-nodes.html#cb36-6"></a>#SBATCH --mail-user=your_email    # specify your email</span>
<span id="cb36-7"><a href="running-jobs-on-compute-nodes.html#cb36-7"></a>#SBATCH --output=STD.out          # save standard output to STD.out</span>
<span id="cb36-8"><a href="running-jobs-on-compute-nodes.html#cb36-8"></a>#SBATCH --error=STD.err           # save std. error output to STD.out</span>
<span id="cb36-9"><a href="running-jobs-on-compute-nodes.html#cb36-9"></a>#SBATCH -c 4                      # request 4 CPUs</span>
<span id="cb36-10"><a href="running-jobs-on-compute-nodes.html#cb36-10"></a>#SBATCH --time=30<span class="ch">:00</span>              # set total run time limit to 30mins <span class="dt">(</span>days-hrs<span class="ch">:mins:secs</span><span class="dt">)</span></span>
<span id="cb36-11"><a href="running-jobs-on-compute-nodes.html#cb36-11"></a>#SBATCH --mem=5000                # request 5G memory</span>
<span id="cb36-12"><a href="running-jobs-on-compute-nodes.html#cb36-12"></a></span>
<span id="cb36-13"><a href="running-jobs-on-compute-nodes.html#cb36-13"></a>module load StdEnv/2023           # load StdEnv/2020 software environment</span>
<span id="cb36-14"><a href="running-jobs-on-compute-nodes.html#cb36-14"></a>module load python/3.11.5         # load python module</span>
<span id="cb36-15"><a href="running-jobs-on-compute-nodes.html#cb36-15"></a>source ~/myenv/bin/activate        # load my python virtual environment</span>
<span id="cb36-16"><a href="running-jobs-on-compute-nodes.html#cb36-16"></a>python python_test.py             # run python code</span></code></pre></div>
<p>The first line in the above script tells the system which shell to use when running the script.</p>
<p>The <code>#SBATCH</code> lines (line 2 to 11) are SLURM commands specifying options for scheduling the job. See the comment on each line (starting with the second <code>#</code> sign) for what those options are. Adjust them to fit your need.</p>
<p><strong>An important note:</strong> under the current cluster configuration, each job is restricted to run on a single node, i.e., a single parallel job can only take advantage of the memory and multiple CPUs on a single node. As a result, do not request more than 24 CPUs and 240G memory as that’s the resource capacity for each compute node in the standard partition. In fact, since the Operating System on a node would need resources as well, the maximum CPUs and memory you request (if needed) should be slightly lower than the full capacity (e.g., 23 CPUs and 220G memory).</p>
<p>Line 13 and 14 load the StdEnv/2023 software environment and the Python module. In general, you will load the Python module that you have setup for your project (see the section on <a href="using-software.html#python-setup">Python Setup</a> for more details). In this example, we load the Python 3.11.5 module. If you have a Python virtual environment setup for your code/project, you would also activate the environment here (after loading the Python module). In the example, line 15 loads the <code>myenv</code> virtual environment.</p>
<p>Line 16 runs the Python code (<code>python_test.py</code>). Note that you do not need to use <code>nohup</code> or <code>&amp;</code> to run your code as you would normally do when running code in batch mode on RRN itself.</p>
<p>You would simply adjust line 13 to 16 if you use other software (i.e., not Python). Below are a few examples.</p>
<p>For R,</p>
<div class="sourceCode" id="cb37" startFrom="13"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash" style="counter-reset: source-line 12;"><span id="cb37-13"><a href="running-jobs-on-compute-nodes.html#cb37-13"></a><span class="ex">module</span> load StdEnv/2023</span>
<span id="cb37-14"><a href="running-jobs-on-compute-nodes.html#cb37-14"></a><span class="ex">module</span> load r/4.4.0</span>
<span id="cb37-15"><a href="running-jobs-on-compute-nodes.html#cb37-15"></a><span class="ex">Rscript</span> mycode.R</span></code></pre></div>
<p>For Matlab,</p>
<div class="sourceCode" id="cb38" startFrom="13"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash" style="counter-reset: source-line 12;"><span id="cb38-13"><a href="running-jobs-on-compute-nodes.html#cb38-13"></a><span class="ex">module</span> load StdEnv/2023</span>
<span id="cb38-14"><a href="running-jobs-on-compute-nodes.html#cb38-14"></a><span class="ex">module</span> load matlab/R2024b</span>
<span id="cb38-15"><a href="running-jobs-on-compute-nodes.html#cb38-15"></a><span class="ex">matlab</span> <span class="at">-nodesktop</span> <span class="at">-nosplash</span> <span class="at">-nodisplay</span> <span class="op">&lt;</span>matlab_test.m</span></code></pre></div>
<p>For Stata 18,</p>
<div class="sourceCode" id="cb39" startFrom="13"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash" style="counter-reset: source-line 12;"><span id="cb39-13"><a href="running-jobs-on-compute-nodes.html#cb39-13"></a><span class="ex">stata</span> <span class="at">-b</span> do filename</span></code></pre></div>
<p>For Stata 17,</p>
<div class="sourceCode" id="cb40" startFrom="13"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash" style="counter-reset: source-line 12;"><span id="cb40-13"><a href="running-jobs-on-compute-nodes.html#cb40-13"></a><span class="ex">module</span> load stata17</span>
<span id="cb40-14"><a href="running-jobs-on-compute-nodes.html#cb40-14"></a><span class="ex">stata</span> <span class="at">-b</span> do filename</span></code></pre></div>
<p>For SAS,</p>
<div class="sourceCode" id="cb41" startFrom="13"><pre class="sourceCode numberSource bash numberLines"><code class="sourceCode bash" style="counter-reset: source-line 12;"><span id="cb41-13"><a href="running-jobs-on-compute-nodes.html#cb41-13"></a><span class="ex">sas</span> mycode.sas</span></code></pre></div>
</div>
<div id="submitting-jobs-to-compute-nodes" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Submitting Jobs to Compute Nodes<a href="running-jobs-on-compute-nodes.html#submitting-jobs-to-compute-nodes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To submit your job, use the <code>sbatch</code> command. A job ID will be returned if it’s successful.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="running-jobs-on-compute-nodes.html#cb42-1" tabindex="-1"></a><span class="ex">sbatch</span> job.sh       <span class="co"># job.sh is the name of the job script </span></span></code></pre></div>
<p>Your job may wait in a queue for some time until the requested resources are available for you.</p>
<p>Sometimes, you may want to check the current availability of resources on compute nodes. The below <code>sinfo</code> commands could be useful.</p>
<p>List all compute nodes available in the standard partition and their resources (total CPUs, memory, etc.)</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="running-jobs-on-compute-nodes.html#cb43-1" tabindex="-1"></a><span class="ex">sinfo</span> <span class="at">-p</span> standard <span class="at">--Node</span> <span class="at">--long</span> </span></code></pre></div>
<p>List current resource availability of each compute node in the standard partition, including node A/I/O/T (Allocated/Idle/Other/Total), CPU A/I/O/T, and total and free memory.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="running-jobs-on-compute-nodes.html#cb44-1" tabindex="-1"></a><span class="ex">sinfo</span> <span class="at">-p</span> standard <span class="at">--Node</span> <span class="at">-o</span><span class="st">&quot;%8N %14F %13C %6m %e&quot;</span> </span></code></pre></div>
</div>
<div id="managing-jobs-on-compute-nodes" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Managing Jobs on Compute Nodes<a href="running-jobs-on-compute-nodes.html#managing-jobs-on-compute-nodes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Show status of jobs submitted.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="running-jobs-on-compute-nodes.html#cb45-1" tabindex="-1"></a><span class="ex">squeue</span> <span class="at">--user</span> <span class="op">&lt;</span>your_user_name<span class="op">&gt;</span></span>
<span id="cb45-2"><a href="running-jobs-on-compute-nodes.html#cb45-2" tabindex="-1"></a><span class="ex">squeue</span> <span class="at">--job</span> <span class="op">&lt;</span>job_id<span class="op">&gt;</span></span>
<span id="cb45-3"><a href="running-jobs-on-compute-nodes.html#cb45-3" tabindex="-1"></a><span class="ex">squeue</span> <span class="at">--start</span> <span class="at">--job</span> <span class="op">&lt;</span>job_id<span class="op">&gt;</span>   <span class="co"># get an estimation for when a job will run</span></span></code></pre></div>
<p>Cancel jobs.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="running-jobs-on-compute-nodes.html#cb46-1" tabindex="-1"></a><span class="ex">scancel</span> <span class="op">&lt;</span>job_id<span class="op">&gt;</span>                <span class="co"># kill a job with a job ID &lt;job_id&gt;</span></span>
<span id="cb46-2"><a href="running-jobs-on-compute-nodes.html#cb46-2" tabindex="-1"></a><span class="ex">scancel</span> <span class="at">-u</span> <span class="op">&lt;</span>your_user_name<span class="op">&gt;</span>     <span class="co"># kill all jobs for user &lt;your_user_name&gt; </span></span></code></pre></div>
</div>
<div id="best-practice-1" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Best Practice<a href="running-jobs-on-compute-nodes.html#best-practice-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Debug your code well before submitting it to run on compute nodes. You could debug a less resource-intensive version of your code on your own computer or on RRN. You could also request a small interactive session on a compute node to debug your code. To do so, use the <code>salloc</code> command.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="running-jobs-on-compute-nodes.html#cb47-1" tabindex="-1"></a><span class="ex">salloc</span> <span class="at">-c</span> 4 <span class="at">--mem</span><span class="op">=</span>6g      <span class="co"># start a 4-CPU 6G memory interactive session </span></span></code></pre></div>
<p>When debugging your code, monitor CPU and memory usage so you could estimate how many CPUs and memory you would need to request when running your code on compute nodes. You may request a bit more resources than what your code will actually need. However, don’t request excessive resources. Note that the more resources you request, the longer queuing time (wait time before the code actually runs) you may experience as the compute nodes are also shared and may not have the requested resources available at the time of your request.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="using-software.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linux-command-quick-reference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/tdmdal/computing-research/edit/master/03-compute-nodes.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
